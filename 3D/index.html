 <!DOCTYPE html>
 <html>
	<head>
		<title>3D cross section view</title>
		<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
		<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1">
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.css" />
		<style type="text/css"> 
			.ui-mobile .ui-page { min-height: 300px; overflow: hidden; }
			html,body { 
   				overflow: hidden; 
              		}              		
			#WebGLCanvas {
				position:absolute;
				top:40px;
				height:100%;
				overflow: hidden;
			}
		</style>
		<script src="three.js"></script>
		<script src="OrbitControl.js"></script>
		<script src="Detector.js"></script>
		<script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
        	<script src="http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.js"></script>
		<script src="http://threejs.org/examples/js/libs/stats.min.js"></script>
	</head>
	<body>
		<div data-role="page" id="index">
        		<div data-theme="b" data-role="header">
                		<h1>Seismic Eruptions</h1>
				<a href="#options" class="ui-btn ui-icon-info ui-mini ui-btn-icon-notext ui-corner-all">Options</a>
				<a href="#settings" class="ui-btn ui-icon-gear ui-mini ui-btn-icon-notext ui-corner-all">Settings</a>
            		</div>
			<div data-role="panel" data-theme="b" data-display="overlay" id="options">
				<div id="info" class="ui-bar ui-body-a"></div>
				<div class="ui-bar ui-body-b">
					<p id="startdate"></p>
					<p id="enddate"></p>
					<p id="magcutoff"></p>
				</div>
				<div id="rendererInfo"></div>
			</div>
			<div data-role="panel" data-position="right" data-display="overlay" data-theme="b" id="settings">
				<form>
					<div class="ui-field-contain">
						<label for="thumbnail">2D Thumbnail</label>
						<input data-role="flipswitch" data-mini="true" type="checkbox" name="plates" id="thumbnail" onchange="thumbnailToggle()" checked="true">
					</div>
					<div class="ui-field-contain">
						<label for="mapToggle">Map layer</label>
						<input data-role="flipswitch" data-mini="true" type="checkbox" name="plates" id="maptoggle" onchange="mapToggle()" checked="true">
					</div>
				</form>
			</div>			
			<div id="WebGLCanvas">
				<div style="width: 210px; height: 210px; opacity: 0.9; cursor: pointer; position: absolute; bottom: 0px; right:0px" id="iframe2d"><iframe id="frame" src="frame.html" height="220px" width="100%"></iframe></div>
			</div>			
		</div>
		<!-- URL parameter fetcher -->
		<script>
		function getURLParameter(name) {
				return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search)||[,""])[1].replace(/\+/g, '%20'))||null
		}
		
		//alert("frame.html?x1="+getURLParameter("x1")+"&x2="+getURLParameter("x2")+"&x3="+getURLParameter("x3")+"&x4="+getURLParameter("x4")+"&y1="+getURLParameter("y1")+"&y2="+getURLParameter("y2")+"&y3="+getURLParameter("y3")+"&y4="+getURLParameter("y4"));
			
		</script>
		<!-- This script helps convert latitude longitude values from the 2D map into 3D xyz coordinates centered at 0,0,0 -->
		<script src="latlonTo3D.js"></script>
		<!-- This script gets the limits of the mapbox in the projection -->
		<script src="getMapLimits.js"></script>
		<!-- This script creates a three.js scene and a 3D array of boxes with map - tiles mapped to their top face -->
		<script src="mapbox.js"></script>
		<!-- This script adds earthquake plottings to the mapbox in the scene -->
		<script src="rainbowvis.js"></script>
		<script src="3Dplot.js"></script>
		<script>
			document.getElementById("frame").src="frame.html?x1="+getURLParameter('x1')+"&x2="+getURLParameter('x2')+"&x3="+getURLParameter('x3')+"&x4="+getURLParameter('x4')+"&y1="+getURLParameter('y1')+"&y2="+getURLParameter('y2')+"&y3="+getURLParameter('y3')+"&y4="+getURLParameter('y4')+"&startdate="+startdate+"&enddate="+enddate+"&mag="+mag;
		</script>
	</body>
</html>
