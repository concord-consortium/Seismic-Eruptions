<!DOCTYPE html>
<html>
    <head>
        <title>Seismic Eruptions</title>
        <meta http-equiv='Content-Type' content='text/html, charset=utf-8'/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, target-densityDpi=device-dpi"/>
		<link rel="stylesheet" href="//code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.css" />
        <link rel="stylesheet" href="http://leafletjs.com/dist/leaflet.css" />
		<link rel="stylesheet" href="Draw/leaflet.draw.css" />
		<!--<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">-->
		<link rel="stylesheet" href="css/font-awesome.css" />
        <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>
		<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
        <script src="http://leafletjs.com/dist/leaflet.js"></script>
		<style>
			.ui-content {
				position: absolute;
				top: 40px;
				right: 0;
				bottom: 0;
				left: 0;
				padding: 0;
			}
			#map {
				height: 100%;
				position:absolute;
				top:0;
				bottom:0;
				left:0;
				right:0;
				margin: 0;
				padding: 0;
			}
			.ui-icon-knife:after {
				background-image: url("images/knife-dashed-line.png");
				background-size: 18px 18px;
			}
		</style>
    </head>
    <body>
        <div data-role="page" id="index">
            <div data-theme="b" data-role="header">
                <h1>Seismic Eruptions</h1>
				<a href="#options" class="ui-btn ui-icon-info ui-mini ui-btn-icon-notext ui-corner-all">Options</a>
				<div data-role="controlgroup" data-type="horizontal" class="ui-mini ui-btn-right">
					<a href="#" class="ui-btn ui-btn-b ui-icon-knife ui-mini ui-btn-icon-notext ui-corner-all" id="drawingTool" onclick="startdrawing()">Draw Cross-Section</a>
					<a href="#settings" class="ui-btn ui-icon-gear ui-mini ui-btn-icon-notext ui-corner-all">Settings</a>
				</div>
            </div>
            <div data-role="panel" data-theme="b" data-display="overlay" id="options">
				<div id="info" class="ui-bar ui-body-a"></div>
				<div class="ui-bar ui-body-b">
					<p id="startdate"></p>
					<p id="enddate"></p>
					<p id="magcutoff"></p>
					<a href="#editparams" data-rel="popup" data-position-to="window" class="ui-btn ui-shadow ui-corner-all ui-mini ui-icon-edit ui-btn-icon-right" id="changeparams"> Change parameters </a>
				</div>
			</div>
			 <div data-role="panel" data-position="right" data-display="overlay" data-theme="b" id="settings">
				<form>
					<label>
						<input type="checkbox" name="plates" id="plates">Display plate boundaries
					</label>
					<div class="ui-field-contain ui-mini">
						<select name="mapselector" id="mapselector" data-mini="true">
							<option value="1">PRCC Earthquake density map</option>
							<option value="2">Satellite map</option>
							<option value="3">OSM map</option>
						</select>
					</div>
				</form>
			</div>
			<div data-role="popup" id="editparams" data-theme="a" class="ui-corner-all">
				<h3>Edit the parameters</h3>
				<input type="text" data-role="date">
				<a href="#" data-rel="back" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-mini ui-icon-check ui-btn-icon-right" id="editparamsenter"> Load </a>
				<a href="#" data-rel="back" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-mini ui-icon-delete ui-btn-icon-right" id="editparamscancel"> Cancel </a>
			</div>
            <div data-role="content" data-theme="b">
                <div id="map"></div>
				<div class="ui-bar ui-body-b" style="width:100%;bottom:0px;left:0px;position:absolute"  id="playback">
					<div class="ui-grid-d" id="playcontrols">
						<div class="ui-block-a"><a class="ui-btn ui-shadow ui-icon-fa ui-icon-fa-play ui-corner-all" id="play"></a></div>
						<div class="ui-block-b"><a class="ui-btn ui-shadow ui-icon-fa ui-icon-fa-pause ui-corner-all" id="pause"></a></div>
						<div class="ui-block-c"><a class="ui-btn ui-shadow ui-icon-fa ui-icon-fa-forward ui-corner-all" id="speedup"></a></div>
						<div class="ui-block-d"><a class="ui-btn ui-shadow ui-icon-fa ui-icon-fa-backward ui-corner-all" id="speeddown"></a></div>
					</div>
					<div class="ui-grid-a">
						<div class="ui-block-a"><div id="slider" style="height:10px;width:90%"></div></div>
						<div class="ui-block-b" id="date"></div>
					</div>
				</div>
				<div class="ui-bar ui-mini ui-body-b" style="width:100%;bottom:0px;position:absolute;display:none" id="crosssection">
					<a class="ui-btn ui-btn-inline" onclick="render()">View Cross Section</a>
					<a class="ui-btn ui-btn-inline" onclick="editdrawing()">Edit</a>
					<a class="ui-btn ui-btn-inline" onclick="editsave()">Save</a>
					<a class="ui-btn ui-btn-inline" onclick="editsave()" id="drawingToolDone">Done</a>
				</div>
			</div>
			
        </div>
		<script>
			function getURLParameter(name) {
				return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search)||[,""])[1].replace(/\+/g, '%20'))||null
			}
		</script>
		
		<script src="KML.js"></script>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/latest/TweenMax.min.js"></script>
		<script src="rainbowvis.js"></script>
		<script src="Draw/editedLibs/src/ext/TouchEvents.js"></script>
		<script src="Draw/editedLibs/src/Leaflet.draw.js"></script>
		<script src="Draw/editedLibs/src/draw/handler/Draw.Feature.js"></script>
		<script src="Draw/editedLibs/src/draw/handler/latlonTo3D.js"></script>
	
		<script src="Draw/editedLibs/src/ext/GeometryUtil.js"></script>
		<script src="Draw/editedLibs/src/ext/LatLngUtil.js"></script>
		<script src="Draw/editedLibs/src/ext/LineUtil.Intersect.js"></script>
		<script src="Draw/editedLibs/src/ext/Polygon.Intersect.js"></script>
		<script src="Draw/editedLibs/src/ext/Polyline.Intersect.js"></script>
		<script src="Draw/editedLibs/src/Control.Draw.js"></script>
		<script src="Draw/editedLibs/src/Tooltip.js"></script>
		<script src="Draw/editedLibs/src/Toolbar.js"></script>
		<script src="Draw/editedLibs/src/draw/DrawToolbar.js"></script>
		<script src="Draw/editedLibs/src/edit/EditToolbar.js"></script>
		<script src="Draw/editedLibs/src/edit/handler/EditToolbar.Edit.js"></script>
		<script src="Draw/editedLibs/src/edit/handler/EditToolbar.Delete.js"></script>
		<script src="Draw/editedLibs/src/edit/handler/Edit.CrossSection.js"></script>
		<script src="Draw/editedLibs/src/draw/handler/Draw.CrossSection.js"></script>
		<script src="map.js"></script>
		
	
		<script>
			function render(){
				window.open("http://gizmoabhinav.github.io/Seismic-Eruptions/3D/index.html?x1="+toLon(y1)+"&y1="+toLat(x1)+"&x2="+toLon(y2)+"&y2="+toLat(x2)+"&x3="+toLon(y3)+"&y3="+toLat(x3)+"&x4="+toLon(y4)+"&y4="+toLat(x4)+"&mag="+mag+"&startdate="+startdate+"&enddate="+enddate);
			}
			var poly,polyedit;
			function startdrawing(){
				poly = new L.Draw.CrossSection(map, []);
				poly.enable();
			}
			function editdrawing(){
				polyedit = new L.EditToolbar.Edit(map, {featureGroup: drawnItems,
					selectedPathOptions: {
						color: '#fe57a1',
						opacity: 0.6,
						dashArray: '10, 10',

						fill: true,
						fillColor: '#fe57a1',
						fillOpacity: 0.1,

						// Whether to user the existing layers color
						maintainColor: false
					}
				});
				polyedit.enable();
			}
			function editsave(){
				polyedit.save();
				polyedit.disable();
			}
			
		</script>
    </body>
</html>   